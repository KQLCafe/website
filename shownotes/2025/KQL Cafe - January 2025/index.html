
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://kqlcafe.github.io/website/shownotes/2025/KQL%20Cafe%20-%20January%202025/">
      
      
        <link rel="prev" href="../KQL%20Cafe%20-%20February%202025/">
      
      
        <link rel="next" href="../KQL%20Cafe%20-%20June%202025/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>KQL Cafe - January 2025 - KQL Cafe</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="brown" data-md-color-accent="brown">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kql-cafe-january-2025" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="KQL Cafe" class="md-header__button md-logo" aria-label="KQL Cafe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            KQL Cafe
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              KQL Cafe - January 2025
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="brown" data-md-color-accent="brown"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="cyan" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/KQLCafe/website" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    KQL Cafe
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Welcome to KQL Cafe

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../Code%20of%20Cnoduct/" class="md-tabs__link">
        
  
  
    
  
  Code of Conduct

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../KustoCon/KustoCon%202024/" class="md-tabs__link">
          
  
  
    
  
  KustoCon

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Learn%20KQL/LearnKQL/" class="md-tabs__link">
          
  
  
    
  
  Learn KQL

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../2022/KQL%20Cafe%20-%20%20January%202022/" class="md-tabs__link">
          
  
  
    
  
  Shownotes

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="KQL Cafe" class="md-nav__button md-logo" aria-label="KQL Cafe" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 89 89">
  <path d="M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z" />
  <path d="M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z" style="fill-opacity: 0.5" />
  <path d="M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z" />
  <path d="M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z" style="fill-opacity: 0.25" />
</svg>

    </a>
    KQL Cafe
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/KQLCafe/website" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    KQL Cafe
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome to KQL Cafe
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Code%20of%20Cnoduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code of Conduct
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    KustoCon
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    KustoCon
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../KustoCon/KustoCon%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KustoCon 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../KustoCon/KustoCon%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KustoCon 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Learn KQL
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Learn KQL
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Learn%20KQL/LearnKQL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Learn &amp; Practice Kusto Query Language (KQL)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Shownotes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Shownotes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2022
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    2022
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20%20January%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hello KQL
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20April%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Detections - Time
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20August%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe August 2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20February%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Hello from Down Under
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20June%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe June 2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20March%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Workbooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20May%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Scan Operator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20November%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe   November 2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20October%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - October 2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2022/KQL%20Cafe%20-%20September%202022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe September 2022
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2023
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    2023
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20April%20I%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - April 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20April%20II%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - April 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20February%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - February 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20January%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - January 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20June%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - June 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20May%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - May 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20November%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe 28. November 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20October%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe October 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2023/KQL%20Cafe%20-%20September%202023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe September 2023
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2024
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    2024
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20April%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - April 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20August%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - August 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20February%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - 27. February 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20January%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - 31. February 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20June%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - June 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20March%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - 26. March 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20May%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - May 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20November%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - November 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../2024/KQL%20Cafe%20-%20October%202024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - October 2024
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" checked>
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    2025
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    2025
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KQL%20Cafe%20-%20April%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - April 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KQL%20Cafe%20-%20February%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - February 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - January 2025
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - January 2025
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recording-and-presentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recording and Presentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hosts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hosts
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guests
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kql-news" class="md-nav__link">
    <span class="md-ellipsis">
      
        KQL News
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KQL News">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kql-sources-2025-update-bert-jan-pals" class="md-nav__link">
    <span class="md-ellipsis">
      
        KQL Sources - 2025 Update Bert-Jan Pals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intune-device-query-kql-queries-ugur-koc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intune Device Query - KQL Queries - Ugur Koc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kql-blog-posts-from-morten-thomsen" class="md-nav__link">
    <span class="md-ellipsis">
      
        KQL Blog Posts from Morten Thomsen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defender-xdr-advanced-hunting-updates-january-2025" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defender XDR – Advanced Hunting Updates - January 2025
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defender-for-endpoint-aggregated-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defender for Endpoint - Aggregated reporting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#living-off-the-tunnels-iocs-jay-kerai" class="md-nav__link">
    <span class="md-ellipsis">
      
        Living Off The Tunnels IOCS - Jay Kerai
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#successful-network-connections-towards-spamhauss-drop-ranges-excluding-common-browsers-as-client-alex-teixeira" class="md-nav__link">
    <span class="md-ellipsis">
      
        Successful network connections towards SpamHaus's DROP ranges, excluding common browsers as client - Alex Teixeira
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecting-paste-and-run-malware-with-kql-nathan-webb" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detecting 'Paste and Run' malware with KQL - Nathan Webb
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guest" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guest
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learn-kql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learn KQL
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Learn KQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parse_url-parse_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parse_Url &amp; Parse_Path
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-did-you-do-with-kql-this-month" class="md-nav__link">
    <span class="md-ellipsis">
      
        What did you do with KQL this month?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What did you do with KQL this month?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure-devops-security-code-scanning-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Azure DevOps Security - Code Scanning Recommendations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-management-from-tvm-to-graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerability Management from TVM to Graph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfa-fraud-alert-retirement-report-suspicious-activity" class="md-nav__link">
    <span class="md-ellipsis">
      
        MFA Fraud Alert Retirement -&gt; Report Suspicious Activity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entra-id-self-service-password-reset-configuration-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entra ID - Self Service Password Reset - Configuration Changes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KQL%20Cafe%20-%20June%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - June 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KQL%20Cafe%20-%20March%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - March 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KQL%20Cafe%20-%20May%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - May 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KQL%20Cafe%20-%20November%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - November 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../KQL%20Cafe%20-%20October%202025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    KQL Cafe - October 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#recording-and-presentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recording and Presentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hosts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hosts
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guests
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kql-news" class="md-nav__link">
    <span class="md-ellipsis">
      
        KQL News
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KQL News">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kql-sources-2025-update-bert-jan-pals" class="md-nav__link">
    <span class="md-ellipsis">
      
        KQL Sources - 2025 Update Bert-Jan Pals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#intune-device-query-kql-queries-ugur-koc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intune Device Query - KQL Queries - Ugur Koc
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kql-blog-posts-from-morten-thomsen" class="md-nav__link">
    <span class="md-ellipsis">
      
        KQL Blog Posts from Morten Thomsen
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defender-xdr-advanced-hunting-updates-january-2025" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defender XDR – Advanced Hunting Updates - January 2025
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defender-for-endpoint-aggregated-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defender for Endpoint - Aggregated reporting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#living-off-the-tunnels-iocs-jay-kerai" class="md-nav__link">
    <span class="md-ellipsis">
      
        Living Off The Tunnels IOCS - Jay Kerai
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#successful-network-connections-towards-spamhauss-drop-ranges-excluding-common-browsers-as-client-alex-teixeira" class="md-nav__link">
    <span class="md-ellipsis">
      
        Successful network connections towards SpamHaus's DROP ranges, excluding common browsers as client - Alex Teixeira
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#detecting-paste-and-run-malware-with-kql-nathan-webb" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detecting 'Paste and Run' malware with KQL - Nathan Webb
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#guest" class="md-nav__link">
    <span class="md-ellipsis">
      
        Guest
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learn-kql" class="md-nav__link">
    <span class="md-ellipsis">
      
        Learn KQL
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Learn KQL">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parse_url-parse_path" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parse_Url &amp; Parse_Path
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-did-you-do-with-kql-this-month" class="md-nav__link">
    <span class="md-ellipsis">
      
        What did you do with KQL this month?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="What did you do with KQL this month?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#azure-devops-security-code-scanning-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Azure DevOps Security - Code Scanning Recommendations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-management-from-tvm-to-graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Vulnerability Management from TVM to Graph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfa-fraud-alert-retirement-report-suspicious-activity" class="md-nav__link">
    <span class="md-ellipsis">
      
        MFA Fraud Alert Retirement -&gt; Report Suspicious Activity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entra-id-self-service-password-reset-configuration-changes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Entra ID - Self Service Password Reset - Configuration Changes
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="kql-cafe-january-2025">KQL Cafe - January 2025</h1>
<h2 id="recording-and-presentation">Recording and Presentation</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=4tZL5sW-Dbo">Recording</a></li>
</ul>
<h2 id="hosts">Hosts</h2>
<ul>
<li><a href="https://twitter.com/castello_johnny">Gianni</a></li>
<li><a href="https://twitter.com/alexverboon">Alex</a></li>
</ul>
<h2 id="guests">Guests</h2>
<ul>
<li><a href="https://x.com/IanDHanley">Ian Hanley</a></li>
</ul>
<h2 id="kql-news">KQL News</h2>
<h3 id="kql-sources-2025-update-bert-jan-pals">KQL Sources - 2025 Update Bert-Jan Pals</h3>
<p>What started as a single blog is now becoming a yearly trend. More and more KQL related repositories are created, not only with a focus on security but also Intune, Entra and Azure Monitor related queries. Dive in and discover how these new additions can help you tackle challenges or give you new ideas for the new year.</p>
<p><a href="https://kqlquery.com/posts/kql-sources-2025/">KQL Sources</a></p>
<h3 id="intune-device-query-kql-queries-ugur-koc">Intune Device Query - KQL Queries - Ugur Koc</h3>
<p>This repository contains a comprehensive collection of KQL (Kusto Query Language) queries specifically designed for Microsoft Intune Device Query. These queries are ready to use and cover various aspects of device management, monitoring, and troubleshooting.</p>
<p><a href="https://github.com/ugurkocde/IntuneDeviceQuery">IntuneDeviceQuery</a></p>
<h3 id="kql-blog-posts-from-morten-thomsen">KQL Blog Posts from Morten Thomsen</h3>
<ol>
<li>Understanding KQL: The Basics (November 19, 2024)</li>
<li>Time-Based Queries and Functions (November 22, 2024)</li>
<li>Advanced Filtering Techniques in KQL (November 26, 2024)</li>
<li>KQL Variables to Optimize Your Query (November 29, 2024)</li>
<li>Visualizing Data with KQL (December 3, 2024)</li>
</ol>
<p><a href="https://www.mtsec.dk/blog">Blog Posts</a></p>
<h3 id="defender-xdr-advanced-hunting-updates-january-2025">Defender XDR – Advanced Hunting Updates - January 2025</h3>
<p>(Preview) In advanced hunting, Microsoft Defender portal users can now use the adx() operator to query tables stored in Azure Data Explorer. You no longer need to go to log analytics in Microsoft Sentinel to use this operator if you are already in Microsoft Defender.</p>
<p>(GA) In advanced hunting, you can now add your frequently used schema tables, functions, queries, and detection rules in the Favorites sections under each tab for quicker access.</p>
<p>(Preview) The Link to incident feature in Microsoft Defender advanced hunting now allows linking of Microsoft Sentinel query results. In both the Microsoft Defender unified experience and in Defender XDR advanced hunting, you can now specify whether an entity is an impacted asset or related evidence.</p>
<p><a href="https://learn.microsoft.com/en-us/defender-xdr/whats-new#january-2025">Reference</a></p>
<h3 id="defender-for-endpoint-aggregated-reporting">Defender for Endpoint - Aggregated reporting</h3>
<p>Aggregated reporting addresses constraints on event reporting in Microsoft Defender for Endpoint. Aggregated reporting extends signal reporting intervals to significantly reduce the size of reported events while preserving essential event properties.</p>
<p>Defender for Endpoint reduces noise in collected data to improve the signal-to-noise ratio while balancing product performance and efficiency. It limits data collection to maintain this balance.</p>
<p>With aggregated reporting, Defender for Endpoint ensures that all essential event properties valuable to investigation and threat hunting activities are continuously collected. It does this by extended reporting intervals of one hour, which reduces the size of reported events and enables efficient yet valuable data collection.</p>
<p>When aggregated reporting is turned on, you can query for a summary of all supported event types, including low-efficacy telemetry, that you can use for investigation and hunting activities.</p>
<p><a href="https://learn.microsoft.com/en-us/defender-endpoint/aggregated-reporting">Reference</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">union</span><span class="w"> </span><span class="n">DeviceFileEvents</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceLogonEvents</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceNetworkEvents</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceProcessEvents</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ActionType</span><span class="w"> </span><span class="k">contains</span><span class="w"> </span><span class="s">&quot;Aggregate&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="k">count</span><span class="p">()</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">ActionType</span>
</code></pre></div>
<h3 id="living-off-the-tunnels-iocs-jay-kerai">Living Off The Tunnels IOCS - Jay Kerai</h3>
<p><a href="https://www.kqlsearch.com/query/Living%20Off%20The%20Tunnels%20Iocs&amp;cm5bpz7oo00b9tj0f2peo6wm0">Query</a></p>
<h3 id="successful-network-connections-towards-spamhauss-drop-ranges-excluding-common-browsers-as-client-alex-teixeira">Successful network connections towards SpamHaus's DROP ranges, excluding common browsers as client - Alex Teixeira</h3>
<p><a href="https://gist.github.com/inodee/dec2550ae15ba7f0aeca7e911c96db90">Query</a></p>
<h3 id="detecting-paste-and-run-malware-with-kql-nathan-webb">Detecting 'Paste and Run' malware with KQL - Nathan Webb</h3>
<p><a href="https://www.linkedin.com/pulse/detecting-paste-run-malware-kql-nathan-webb-89ale/">Query</a></p>
<h2 id="guest">Guest</h2>
<ul>
<li><a href="https://x.com/IanDHanley">Ian Hanley on Twitter</a></li>
<li><a href="https://www.linkedin.com/in/ianhanley/">Ian Hanley on LinkedIn</a></li>
<li><a href="https://hanleycloudsolutions.com/">Website</a></li>
<li>
<p><a href="https://www.hanley.cloud/">Website</a></p>
</li>
<li>
<p><a href="https://www.hanley.cloud/2023-05-10-Workspace-Transformation-Rules/">Workspace Transformation Rules</a></p>
</li>
<li><a href="https://www.hanley.cloud/2024-01-19-PowerBI-&amp;-Log-Analytics-Workspace/">Powerbi &amp; Log Analytics Workspace</a></li>
</ul>
<p>You will find many of the queries demonstrated here: <a href="https://github.com/EEN421/KQL-Queries">KQL Repository</a></p>
<h2 id="learn-kql">Learn KQL</h2>
<h3 id="parse_url-parse_path">Parse_Url &amp; Parse_Path</h3>
<h2 id="what-did-you-do-with-kql-this-month">What did you do with KQL this month?</h2>
<h3 id="azure-devops-security-code-scanning-recommendations">Azure DevOps Security - Code Scanning Recommendations</h3>
<p><a href="https://github.com/alexverboon/Hunting-Queries-Detection-Rules/blob/main/AzureDevOps/AzureDevOps%20-%20CodeRecommendations.md">Query</a></p>
<h3 id="vulnerability-management-from-tvm-to-graph">Vulnerability Management from TVM to Graph</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">let</span><span class="w"> </span><span class="n">SeverityTable</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">datatable</span><span class="p">(</span><span class="n">Severity</span><span class="p">:</span><span class="k">string</span><span class="p">,</span><span class="n">ZeroDay</span><span class="p">:</span><span class="k">bool</span><span class="p">,</span><span class="n">HasExploit</span><span class="p">:</span><span class="k">bool</span><span class="p">,</span><span class="n">ExploitVerified</span><span class="p">:</span><span class="k">bool</span><span class="p">,</span><span class="n">DueDate</span><span class="p">:</span><span class="n">timespan</span><span class="p">,</span><span class="n">Score</span><span class="p">:</span><span class="k">int</span><span class="p">)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">[</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="n">h</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10) + ZeroDay (5) + HasExploit (3) + ExploitVerified (5)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="n">h</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10) + HasExploit (3) + ExploitVerified (5)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="n">h</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10) + ZeroDay (5) + ExploitVerified (5)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">24</span><span class="n">h</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10) + ExploitVerified (5)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="n">h</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10) + ZeroDay (5) + HasExploit (3)</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="n">h</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10) + HasExploit (3)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">24</span><span class="n">h</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10) + ZeroDay (5)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">    </span><span class="s">&quot;Critical&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">48</span><span class="n">h</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="w">  </span><span class="c">// Critical (10)</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="n">d</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8) + ZeroDay (5) + HasExploit (3) + ExploitVerified (5)</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="n">d</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8) + HasExploit (3) + ExploitVerified (5)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="n">d</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8) + ZeroDay (5) + ExploitVerified (5)</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="n">d</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8) + ExploitVerified (5)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="n">d</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8) + ZeroDay (5) + HasExploit (3)</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="n">d</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8) + HasExploit (3)</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="n">d</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8) + ZeroDay (5)</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">    </span><span class="s">&quot;High&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="n">d</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="w">       </span><span class="c">// High (8)</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="n">d</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="w">    </span><span class="c">// Medium (5) + ZeroDay (5) + HasExploit (3) + ExploitVerified (5)</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="n">d</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w">    </span><span class="c">// Medium (5) + HasExploit (3) + ExploitVerified (5)</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="n">d</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="w">    </span><span class="c">// Medium (5) + ZeroDay (5) + ExploitVerified (5)</span>
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="n">d</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="w">    </span><span class="c">// Medium (5) + ExploitVerified (5)</span>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="n">d</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="w">    </span><span class="c">// Medium (5) + ZeroDay (5) + HasExploit (3)</span>
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">45</span><span class="n">d</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="w">     </span><span class="c">// Medium (5) + HasExploit (3)</span>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">45</span><span class="n">d</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="w">    </span><span class="c">// Medium (5) + ZeroDay (5)</span>
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a><span class="w">    </span><span class="s">&quot;Medium&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">60</span><span class="n">d</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="w">     </span><span class="c">// Medium (5)</span>
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="n">d</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="w">       </span><span class="c">// Low (3) + ZeroDay (5) + HasExploit (3) + ExploitVerified (3)</span>
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">45</span><span class="n">d</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="w">        </span><span class="c">// Low (3) + HasExploit (3) + ExploitVerified (3)</span>
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">60</span><span class="n">d</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="w">       </span><span class="c">// Low (3) + ZeroDay (5) + ExploitVerified (3)</span>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">90</span><span class="n">d</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="w">        </span><span class="c">// Low (3) + ExploitVerified (3)</span>
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="n">d</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="w">       </span><span class="c">// Low (3) + ZeroDay (5) + HasExploit (3)</span>
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="n">d</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="w">        </span><span class="c">// Low (3) + HasExploit (3)</span>
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="n">d</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="w">        </span><span class="c">// Low (3) + ZeroDay (5)</span>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a><span class="w">    </span><span class="s">&quot;Low&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">120</span><span class="n">d</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="w">       </span><span class="c">// Low (3)</span>
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">60</span><span class="n">d</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="w">      </span><span class="c">// None (1) + ZeroDay (5) + HasExploit (3) + ExploitVerified (3)</span>
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">90</span><span class="n">d</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="w">       </span><span class="c">// None (1) + HasExploit (3) + ExploitVerified (3)</span>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">120</span><span class="n">d</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="w">      </span><span class="c">// None (1) + ZeroDay (5) + ExploitVerified (3)</span>
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">180</span><span class="n">d</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="w">      </span><span class="c">// None (1) + ExploitVerified (3)</span>
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="n">d</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="w">      </span><span class="c">// None (1) + ZeroDay (5) + HasExploit (3)</span>
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="n">d</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="w">      </span><span class="c">// None (1) + HasExploit (3)</span>
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">180</span><span class="n">d</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="w">      </span><span class="c">// None (1) + ZeroDay (5)</span>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a><span class="w">    </span><span class="s">&quot;None&quot;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">365</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="w">       </span><span class="c">// None (1)</span>
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a><span class="p">];</span>
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a><span class="n">ExposureGraphEdges</span>
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a><span class="p">|</span><span class="w"> </span><span class="n">make</span><span class="p">-</span><span class="n">graph</span><span class="w"> </span><span class="n">SourceNodeId</span><span class="w"> </span><span class="p">--&gt;</span><span class="w"> </span><span class="n">TargetNodeId</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">ExposureGraphNodes</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">NodeId</span>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a><span class="p">|</span><span class="w"> </span><span class="n">graph</span><span class="p">-</span><span class="n">match</span><span class="w"> </span><span class="n">cycles</span><span class="p">=</span><span class="n">none</span><span class="w"> </span><span class="p">(</span><span class="n">CVE</span><span class="p">)-[</span><span class="n">affecting</span><span class="p">]-&gt;(</span><span class="n">Device</span><span class="p">)-[</span><span class="n">loggedonusers</span><span class="p">*</span><span class="mf">1..3</span><span class="p">]-&gt;(</span><span class="n">User</span><span class="p">)</span>
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeLabel</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;Cve&quot;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span>
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a><span class="w">    </span><span class="n">affecting</span><span class="err">.</span><span class="n">EdgeLabel</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">&quot;affecting&quot;</span><span class="w"> </span><span class="k">and</span>
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a><span class="c">//    not (Device.NodeProperties.rawData.sensorHealthState in(&quot;InactiveGoneDark&quot;,&quot;InactiveRecent&quot;)) and</span>
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a><span class="w">    </span><span class="n">loggedonusers</span><span class="err">.</span><span class="n">EdgeLabel</span><span class="w"> </span><span class="n">in</span><span class="p">(</span><span class="s">&quot;has credentials of&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;frequently logged in by&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">and</span>
<a id="__codelineno-1-51" name="__codelineno-1-51" href="#__codelineno-1-51"></a><span class="w">    </span><span class="n">User</span><span class="err">.</span><span class="n">NodeLabel</span><span class="w"> </span><span class="n">in</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">,</span><span class="s">&quot;serviceprincipal&quot;</span><span class="p">)</span>
<a id="__codelineno-1-52" name="__codelineno-1-52" href="#__codelineno-1-52"></a><span class="w">    </span><span class="k">project</span><span class="w"> </span>
<a id="__codelineno-1-53" name="__codelineno-1-53" href="#__codelineno-1-53"></a><span class="w">        </span><span class="n">CveId</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeName</span><span class="p">,</span><span class="w"> </span>
<a id="__codelineno-1-54" name="__codelineno-1-54" href="#__codelineno-1-54"></a><span class="w">            </span><span class="n">Severity</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">severity</span><span class="p">),</span>
<a id="__codelineno-1-55" name="__codelineno-1-55" href="#__codelineno-1-55"></a><span class="w">            </span><span class="n">ZeroDay</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tobool</span><span class="p">(</span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">isZeroDay</span><span class="p">),</span>
<a id="__codelineno-1-56" name="__codelineno-1-56" href="#__codelineno-1-56"></a><span class="w">            </span><span class="n">HasExploit</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tobool</span><span class="p">(</span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">hasExploit</span><span class="p">),</span>
<a id="__codelineno-1-57" name="__codelineno-1-57" href="#__codelineno-1-57"></a><span class="w">            </span><span class="n">ExploitVerified</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tobool</span><span class="p">(</span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">isExploitVerified</span><span class="p">),</span>
<a id="__codelineno-1-58" name="__codelineno-1-58" href="#__codelineno-1-58"></a><span class="w">            </span><span class="n">LastModifiedDate</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">todatetime</span><span class="p">(</span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">lastModifiedDate</span><span class="p">),</span>
<a id="__codelineno-1-59" name="__codelineno-1-59" href="#__codelineno-1-59"></a><span class="w">            </span><span class="n">CvssScore</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">todouble</span><span class="p">(</span><span class="n">tostring</span><span class="p">(</span><span class="n">CVE</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">cvssScore</span><span class="p">)),</span>
<a id="__codelineno-1-60" name="__codelineno-1-60" href="#__codelineno-1-60"></a><span class="w">        </span><span class="n">DeviceName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Device</span><span class="err">.</span><span class="n">NodeName</span><span class="p">,</span>
<a id="__codelineno-1-61" name="__codelineno-1-61" href="#__codelineno-1-61"></a><span class="w">            </span><span class="n">FirstSeenByInventory</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">todatetime</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">firstSeenByInventory</span><span class="p">),</span>
<a id="__codelineno-1-62" name="__codelineno-1-62" href="#__codelineno-1-62"></a><span class="w">            </span><span class="n">LastSeen</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">todatetime</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">lastSeen</span><span class="p">),</span>
<a id="__codelineno-1-63" name="__codelineno-1-63" href="#__codelineno-1-63"></a><span class="w">            </span><span class="n">EntityIds</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Device</span><span class="err">.</span><span class="n">EntityIds</span><span class="p">,</span>
<a id="__codelineno-1-64" name="__codelineno-1-64" href="#__codelineno-1-64"></a><span class="w">            </span><span class="n">SensorHealthState</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">sensorHealthState</span><span class="p">),</span>
<a id="__codelineno-1-65" name="__codelineno-1-65" href="#__codelineno-1-65"></a><span class="w">            </span><span class="n">MachineGroup</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">machineGroup</span><span class="p">),</span>
<a id="__codelineno-1-66" name="__codelineno-1-66" href="#__codelineno-1-66"></a><span class="w">            </span><span class="n">OsPlatformFriendlyName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">osPlatformFriendlyName</span><span class="p">),</span>
<a id="__codelineno-1-67" name="__codelineno-1-67" href="#__codelineno-1-67"></a><span class="w">            </span><span class="n">OsVersionFriendlyName</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">osVersionFriendlyName</span><span class="p">),</span>
<a id="__codelineno-1-68" name="__codelineno-1-68" href="#__codelineno-1-68"></a><span class="w">            </span><span class="n">PublicIP</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">publicIP</span><span class="p">),</span>
<a id="__codelineno-1-69" name="__codelineno-1-69" href="#__codelineno-1-69"></a><span class="w">            </span><span class="n">IsInternetFacing</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tobool</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">isInternetFacing</span><span class="p">),</span>
<a id="__codelineno-1-70" name="__codelineno-1-70" href="#__codelineno-1-70"></a><span class="w">            </span><span class="n">ManualCriticalityLevel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">manualCriticalityLevel</span><span class="p">),</span>
<a id="__codelineno-1-71" name="__codelineno-1-71" href="#__codelineno-1-71"></a><span class="w">            </span><span class="n">DeviceRegistryTags</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tostring</span><span class="p">(</span><span class="n">Device</span><span class="err">.</span><span class="n">NodeProperties</span><span class="err">.</span><span class="n">rawData</span><span class="err">.</span><span class="n">deviceRegistryTags</span><span class="p">),</span>
<a id="__codelineno-1-72" name="__codelineno-1-72" href="#__codelineno-1-72"></a><span class="w">        </span><span class="n">User</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">User</span><span class="err">.</span><span class="n">NodeName</span>
<a id="__codelineno-1-73" name="__codelineno-1-73" href="#__codelineno-1-73"></a><span class="p">|</span><span class="w"> </span><span class="k">lookup</span><span class="w"> </span><span class="n">SeverityTable</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">Severity</span><span class="p">,</span><span class="w"> </span><span class="n">ZeroDay</span><span class="p">,</span><span class="w"> </span><span class="n">HasExploit</span><span class="p">,</span><span class="w"> </span><span class="n">ExploitVerified</span>
<a id="__codelineno-1-74" name="__codelineno-1-74" href="#__codelineno-1-74"></a><span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">RemeditationExpired</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">iif</span><span class="p">(</span><span class="n">LastModifiedDate</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">DueDate</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="n">now</span><span class="p">(),</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-1-75" name="__codelineno-1-75" href="#__codelineno-1-75"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">RemeditationExpired</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">1</span>
<a id="__codelineno-1-76" name="__codelineno-1-76" href="#__codelineno-1-76"></a><span class="p">|</span><span class="w"> </span><span class="k">parse</span><span class="w"> </span><span class="n">EntityIds</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="p">*</span><span class="w"> </span><span class="s">&#39;SenseDeviceId&quot;,&quot;id&quot;:&quot;&#39;</span><span class="w"> </span><span class="n">DeviceId</span><span class="w"> </span><span class="s">&#39;&quot;&#39;</span><span class="w"> </span><span class="p">*</span>
<a id="__codelineno-1-77" name="__codelineno-1-77" href="#__codelineno-1-77"></a><span class="p">|</span><span class="w"> </span><span class="k">project-away</span><span class="w"> </span><span class="n">EntityIds</span>
<a id="__codelineno-1-78" name="__codelineno-1-78" href="#__codelineno-1-78"></a><span class="p">|</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">hint</span><span class="err">.</span><span class="n">shufflekey</span><span class="p">=</span><span class="n">DeviceId</span><span class="w"> </span><span class="n">kind</span><span class="p">=</span><span class="n">inner</span><span class="w"> </span><span class="p">(</span><span class="n">DeviceTvmSoftwareVulnerabilities</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="k">project-keep</span><span class="w"> </span><span class="n">DeviceId</span><span class="p">,</span><span class="w"> </span><span class="n">CveId</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareVendor</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareName</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareVersion</span><span class="p">)</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">DeviceId</span><span class="p">,</span><span class="w"> </span><span class="n">CveId</span>
<a id="__codelineno-1-79" name="__codelineno-1-79" href="#__codelineno-1-79"></a><span class="p">|</span><span class="w"> </span><span class="k">project-away</span><span class="w"> </span><span class="p">*</span><span class="mi">1</span>
<a id="__codelineno-1-80" name="__codelineno-1-80" href="#__codelineno-1-80"></a><span class="p">|</span><span class="w"> </span><span class="k">join</span><span class="w"> </span><span class="n">hint</span><span class="err">.</span><span class="n">shufflekey</span><span class="p">=</span><span class="n">DeviceId</span><span class="w"> </span><span class="n">kind</span><span class="p">=</span><span class="n">leftouter</span><span class="w"> </span><span class="p">(</span><span class="n">DeviceTvmSoftwareEvidenceBeta</span><span class="p">)</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">DeviceId</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareVendor</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareName</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareVersion</span>
<a id="__codelineno-1-81" name="__codelineno-1-81" href="#__codelineno-1-81"></a><span class="p">|</span><span class="w"> </span><span class="k">project-away</span><span class="w"> </span><span class="p">*</span><span class="mi">1</span>
<a id="__codelineno-1-82" name="__codelineno-1-82" href="#__codelineno-1-82"></a><span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">Information</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bag_pack_columns</span><span class="p">(</span><span class="n">CvssScore</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareVendor</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareName</span><span class="p">,</span><span class="w"> </span><span class="n">SoftwareVersion</span><span class="p">,</span><span class="w"> </span><span class="n">RegistryPaths</span><span class="p">,</span><span class="w"> </span><span class="n">DiskPaths</span><span class="p">)</span>
<a id="__codelineno-1-83" name="__codelineno-1-83" href="#__codelineno-1-83"></a><span class="p">|</span><span class="w"> </span><span class="k">summarize</span><span class="w"> </span><span class="n">hint</span><span class="err">.</span><span class="n">shufflekey</span><span class="p">=</span><span class="n">DeviceId</span><span class="w"> </span><span class="n">Score</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">Score</span><span class="p">),</span><span class="w"> </span><span class="n">CVEs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">dcount</span><span class="p">(</span><span class="n">CveId</span><span class="p">),</span><span class="w"> </span><span class="n">ImportantCVEs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">countif</span><span class="p">(</span><span class="n">Score</span><span class="w"> </span><span class="p">&gt;=</span><span class="w"> </span><span class="mi">13</span><span class="p">),</span><span class="w"> </span><span class="n">Evidence</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">make_set</span><span class="p">(</span><span class="n">Information</span><span class="p">)</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">FirstSeenByInventory</span><span class="p">,</span><span class="w"> </span><span class="n">LastSeen</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceId</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceName</span><span class="p">,</span><span class="w"> </span><span class="n">ManualCriticalityLevel</span><span class="p">,</span><span class="w"> </span><span class="n">SensorHealthState</span><span class="p">,</span><span class="w"> </span><span class="n">MachineGroup</span><span class="p">,</span><span class="w"> </span><span class="n">OsPlatformFriendlyName</span><span class="p">,</span><span class="w"> </span><span class="n">OsVersionFriendlyName</span><span class="p">,</span><span class="w"> </span><span class="n">PublicIP</span><span class="p">,</span><span class="w"> </span><span class="n">IsInternetFacing</span><span class="p">,</span><span class="w"> </span><span class="n">DeviceRegistryTags</span>
<a id="__codelineno-1-84" name="__codelineno-1-84" href="#__codelineno-1-84"></a><span class="p">|</span><span class="w"> </span><span class="k">extend</span><span class="w"> </span><span class="n">EvidenceCount</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">array_length</span><span class="p">(</span><span class="n">Evidence</span><span class="p">)</span>
</code></pre></div>
<h3 id="mfa-fraud-alert-retirement-report-suspicious-activity">MFA Fraud Alert Retirement -&gt; Report Suspicious Activity</h3>
<p>Microsoft is retiring the MFA Fraud alert in favor of the replacement feature "Report Suspicious Activity" here's a KQL query to detect these events.</p>
<p><a href="https://github.com/alexverboon/Hunting-Queries-Detection-Rules/blob/main/Entra%20ID/EntraID%20-%20Suspicious%20activity%20reported.md">Query</a></p>
<h3 id="entra-id-self-service-password-reset-configuration-changes">Entra ID - Self Service Password Reset - Configuration Changes</h3>
<p>Microsoft has introduced enhanced logging capabilities for Self-Service Password Reset (SSPR) policy configurations. With this update, any change made to the SSPR policy configuration—including enablement, disablement, or modifications—will generate an audit log entry detailing the change.</p>
<p><a href="https://github.com/alexverboon/Hunting-Queries-Detection-Rules/blob/main/Entra%20ID/EntraID%20-%20SSPR%20Configuration%20Changes.md">Query</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/KQLCafe/website" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/KqlCafe" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/groups/14053778/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.expand", "navigation.indexes", "navigation.instant", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../js/clarity.js"></script>
      
    
  </body>
</html>